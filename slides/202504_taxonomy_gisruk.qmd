---
title: "Understanding Urban Form"
subtitle: "Hierarchical Morphotope Classification based on Gradually Loosening Spatial Restrictions"
author: "Martin Fleischmann and Krasen Samardzhiev"
institute: "Charles University"
# date: "today"
format:
    revealjs:
        theme: [default, ../assets/reveal.scss]
        logo: ../assets/icon.svg
        menu: false
        transition: slide
        navigation-mode: linear
        controls-layout: edges
        progress: true
        include-in-header: ../assets/font.html
        title-slide-attributes:
            data-background-image: ../assets/full_logo.svg
            data-background-size: 15%
            data-background-position: 50% 90%
---


## {background-image="../figures/202504_taxonomy_gisruk/prague_jay_danntine.jpg" .no-text}

::: aside
Prague by Jay Dantine
:::

## {background-image="../figures/202504_taxonomy_gisruk/barcelona.jpg" .no-text}

::: aside
Barcelona
:::

# Urban Morphometrics

<!-- ![Caniggia and Maffei](../figures/202504_taxonomy_gisruk/caniggia-maffei-analisi-tessuti-storici.jpg)

--- -->

::: {.fragment}
> A study of urban form through the means of quantitative assessment of its constituent elements.
:::

---

![](../figures/202504_taxonomy_gisruk/conzen.png)

::: aside
Conzen M (1960) Alnwick, Northumberland: A Study in Town-Plan Analysis. London: George Philip & Son.
:::

## {background-image="../figures/202504_taxonomy_gisruk/arinaldi.jpg" .no-text background-size=contain}

::: aside
Araldi, A. and Fusco, G. (2025), Multi-Level Street-Based Analysis of the Urban Fabric: Developments for a Nationwide Taxonomy. Geographical Analysis, 57: 270-301.
:::


## {background-image="../figures/202504_taxonomy_gisruk/prague.jpg" .no-text background-size=contain}
::: aside
Fleischmann, M., Feliciotti, A., Romice, O., & Porta, S. (2021). Methodological foundation of a numerical taxonomy of urban form. Environment and Planning B, 49(4), 1283-1299.
:::

# HiMoC Aims

- Results align with theory and qualitative work
- Detailed elements as fundamental units - buildings, streets and their configurations
- Scale - applicable to numerous countries

# Study area - Central Europe*

![Germany, Czechia, Austria, Slovakia, Poland, Lithuania](../figures/202504_taxonomy_gisruk/studyarea.png)


## Enclosed Tessellation Cells
![](../figures/202504_taxonomy_gisruk/tess_cell.jpg)

---

## Measured characteristics

---

![](../figures/202410_Nanjing/sdcare.png)

::: aside
Area of tessellation cells in Kraków, Poland
:::

---

![](../figures/202410_Nanjing/swr.png)

::: aside
Shared walls ratio of buildings in Kraków, Poland
:::

---

![](../figures/202410_Nanjing/spw.png)

::: aside
Width of street profile in Kraków, Poland
:::

---

![](../figures/202410_Nanjing/lsdmes.png)

::: aside
Street network meshedness in Kraków, Poland
:::

---

![](../figures/202410_Nanjing/lcdMes_bulidings.png)

::: aside
Street network meshedness in Kraków, Poland
:::


## Gradually Loosening Spatial Restrictions

- Framework for hierarchical spatial clustering relying on:
    1. Intermediate aggregations
    2. Relaxing spatial restrictions as the size of the intermediate aggregations increases.
- Results in a taxonomy starting from individual ETCs


## Three levels of aggregations
1. ETCs to morphotopes
2. Morphotopes to Regional Morphotope Types
3. Regional Morphotope Types clusters to Morphotope Types (taxa)


## Morphotope
::: {.fragment}
> “the smallest urban locality obtaining distinctive character among their neighbours from their particular combination of constituent morphological elements.”
:::



## Three levels of spatial restrictions
1. Immediate - only immediate neighbors can be part of the same cluster.
2. Regional - only neighbours within the same region can be combined. A region is contiguous land around buildings where the nearest neighbour is at maximum 500 meters away.
3. Global - no spatial restrictions

## Regions

![Region around Prague](../figures/202504_taxonomy_gisruk/prague_region.png)

---

![Region around Krakow](../figures/202504_taxonomy_gisruk/krakow_region.png)



## Three algorithms

## 1. Spatial Adaptive Agglomerative Clustering ($SA^3$)
1. Compute a full regionalisation tree with any `sklearn.hierarchy.AgglomerativeClustering` algorithm and spatial restrictions imposed by a `libpysal.graph.Graph` or `libpysal.weights.W`.

---

2. Extraction of contiguous regions with noise ( i.e. some observations will not belong to any of the extracted regions) using hierarchical density-based clustering schemas - `ExcessOfMass` or `leaf`.

<!-- ## Properties
1. Contiguous - observations in the same cluster should be spatially contiguos.
2. Conservative - observations are assigned to a noise cluster if they are not similar in feature space, to any of their geographical neighbours.
3. Multiscale - It is possible to have clusters with internal dissimilarity higher than the external dissimilarity between a pair of other clusters.
4. Dynamic - The final number of clusters is inferred from the data based on a `min_cluster_size` parameter and not predefined.


## Justication
1. By definition morphotopes are spatially contiguous
2. There are multiple types of urban fabric interspersed within a city which should be kept seperate - single family houses around apartment blocks, for example.

---

3. The internal dissimilarity within an industrial area is higher, than the external similarity between a single family housing and a multi-family housing area. Nevertheless, we are interested in getting the three types of coherent units deliniated using one algorithm.

4. We dont know how many morphotopes to look for beforehand. -->

---

![](../figures/202410_Nanjing/morphotopes.png)

::: aside
Morphotope delineation in Kraków, Poland
:::


## 2. Regional clusters
- Complete linkage applied to all the morphotopes within a single region.

---

![](../figures/202410_Nanjing/cut0.png){.r-stretch}

::: aside
Baseline morphotope types in Kraków, Poland
:::


## 3. Recursive K-Means

1. Step 1. - the whole dataset is split into two clusters by performing a kmeans clustering with K=2. 
2. Step $N$. - the algorithm splits each of the clusters from the $N-1$ iteration into two further clusters, again using a kmeans clustering with K=2.
3. The algorithm stops when each cluster has at most 2 members, and the taxonomy is built based on the splits.

---

![](../figures/202504_taxonomy_gisruk/full_dendro.png){.r-stretch}

::: aside
Full dendrogram
:::



# Results
## {background-image="../figures/202504_Berkeley/himoc_map.png" .no-text}

::: aside
[https://uscuni.org/himoc/](https://uscuni.org/himoc/)
:::




# Limitations

- Even cadastral data is of very different quality, there is no consistent definition of what is a building across neighbouring countries, regions or even cities within the same country.

- The morphometric characters are limited to 2d variables, since there is only aggregte height data available that is derived and not recorded.

--- 

- The Kmeans can split classes into sub-classes when its not desirable. For example, Dispersed Linear Development and Linear Development.

- Adding a temporal dimension to the analysis is difficult due to data unavailability.


# Conclusions

Multiple types of urban form in different countries and across the setttlement hierarchy are morphologically close to eachother. 

---

![](../figures/202504_taxonomy_gisruk/examples.png)

---

Nevertheless the heterogeneity of urban form is present even at high levels of aggregation.

---

![Linear development concentration](../figures/202504_taxonomy_gisruk/poland_linear.png)

---

The taxonomy extends existing regional and global classifications.

---

![Local climate zones](../figures/202504_taxonomy_gisruk/lcz.png)

---

- The importance of elements and variables changes as we move through the taxonomy. Capturing and combining aspects of other urban form classifications.

- The GLSR is generalisable. We are using the first law of geography ( spatial autocorrelation ) to turn a computationally intractable problem into a solvable one.


# Open Source Software
- Main repository: https://github.com/uscuni/urban_taxonomy
- Slides: https://uscuni.org/talks/202504_taxonomy_gisruk.html
- Upstream packages : libpysal, neatnet, momepy, geoplanar, shapely, geopandas, spopt
